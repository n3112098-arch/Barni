from .. import loader, utils
import asyncio

class DeleteSelfMessages(loader.Module):
    """–£–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Å–≤–æ–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —á–∞—Ç–µ"""

    strings = {"name": "DelSelf"}

    @loader.command()
    async def dsms(self, m):
        """–£–¥–∞–ª–∏—Ç—å –í–°–ï —Å–≤–æ–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —ç—Ç–æ–º —á–∞—Ç–µ"""
        me = await m.client.get_me()

        await m.edit("üóë –ù–∞—á–∏–Ω–∞—é —É–¥–∞–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π...")

        deleted = 0

        async for msg in m.client.iter_messages(m.chat_id):
            try:
                if msg.sender_id == me.id:
                    await msg.delete()
                    deleted += 1
                    await asyncio.sleep(0.05)  # —á—Ç–æ–±—ã –Ω–µ —Å–ª–æ–≤–∏—Ç—å FloodWait
            except:
                pass

        await m.client.send_message(
            m.chat_id,
            f"‚úîÔ∏è –£–¥–∞–ª–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–π: {deleted}"
        )