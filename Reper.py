from .. import loader, utils
import random

class RapperMod(loader.Module):
    """–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Ä—É—Å—Å–∫–æ–≥–æ —Ä—ç–ø–∞"""

    strings = {"name": "Rapper"}  # ‚Üê –ò–º—è –º–æ–¥—É–ª—è (–∫–∞–∫ –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –≤ Hikka)

    @loader.command()
    async def rapper(self, message):
        """.rapper <—Ç–µ–º–∞> ‚Äî —Å–æ–∑–¥–∞—ë—Ç –∫–æ—Ä–æ—Ç–∫–∏–π —Ä—É—Å—Å–∫–∏–π —Ä—ç–ø"""
        args = utils.get_args_raw(message)
        if not args:
            return await message.edit("‚ùå –£–∫–∞–∂–∏ —Ç–µ–º—É, –Ω–∞–ø—Ä–∏–º–µ—Ä: `.rapper –ª—é–±–æ–≤—å`")

        topic = args.lower()

        # –°–ª–æ–≤–∞ –ø–æ —Ç–µ–º–∞–º
        words = {
            "–ª—é–±–æ–≤—å": ["–ª—é–±–æ–≤—å", "—Å–µ—Ä–¥—Ü–µ", "–æ–≥–æ–Ω—å", "—Å–ª—ë–∑—ã", "–Ω–µ–∂–Ω–æ—Å—Ç—å", "—Ç–µ–Ω–∏", "—Å–≤–µ—Ç", "–¥—É—à–∞", "–º—ã", "–º–µ—á—Ç–∞"],
            "–∂–∏–∑–Ω—å": ["–∂–∏–∑–Ω—å", "–ø—É—Ç—å", "—É–ª–∏—Ü—ã", "—Ç–µ–Ω–∏", "—Ä–∏—Ç–º", "–¥–µ–Ω—å", "–Ω–æ—á—å", "–≤—Ä–µ–º—è", "—Å–∏–ª—ã", "–±–æ—Ä—å–±–∞"],
            "–¥–µ–Ω—å–≥–∏": ["–¥–µ–Ω—å–≥–∏", "–∫–∞—Ä–º–∞–Ω", "—Å–∏–ª–∞", "—É—Å–ø–µ—Ö", "—Ö–∞–π—Ç–µ–∫", "–±–∞–ª–∞–Ω—Å", "–ø—Ä–∏–±—ã–ª—å", "–∫–∞—à–∞", "–ø–æ—Ç–æ–∫", "–±–∞–±–ª–æ"],
            "–¥—Ä—É–∂–±–∞": ["–¥—Ä—É–≥", "–≤–º–µ—Å—Ç–µ", "–ø–æ–¥–¥–µ—Ä–∂–∫–∞", "—Å–º–µ—Ö", "–∫–æ–º–∞–Ω–¥–∞", "—Å–∏–ª–∞", "—Ä–∞–¥–æ—Å—Ç—å", "–≤–µ—Ä–Ω–æ—Å—Ç—å", "—Ä—É–∫–∞", "–¥–≤–∏–∂"],
        }

        # –≠–º–æ–¥–∑–∏ –¥–ª—è —Å—Ç–∏–ª—è
        emojis = ["üî•", "üí•", "‚ö°", "üí£", "‚ú®", "üí´", "üé§", "üéµ", "üíé"]

        # –≤—ã–±–æ—Ä —Å–ª–æ–≤
        pool = words.get(topic, random.choice(list(words.values())))

        # –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º 4 —Å—Ç—Ä–æ–∫–∏ —Ä—ç–ø–∞
        rap_lines = []
        for _ in range(4):
            line_len = random.randint(4, 6)  # —Å–ª–æ–≤ –≤ —Å—Ç—Ä–æ–∫–µ
            line_words = random.choices(pool, k=line_len)

            # –¥–æ–±–∞–≤–ª—è–µ–º —Å–ª—É—á–∞–π–Ω—ã–µ —ç–º–æ–¥–∑–∏ –ø–æ—Å–ª–µ —Å–ª–æ–≤
            line = " ".join(
                [w + random.choice(emojis) if random.random() < 0.35 else w for w in line_words]
            )

            rap_lines.append(line)

        # –î–æ–±–∞–≤–ª—è–µ–º –±–∏—Ç üéµ
        rap_text = "\n".join([f"{line} üéµ" for line in rap_lines])

        await message.edit(f"üé§ –†—ç–ø –Ω–∞ —Ç–µ–º—É: **{topic}**\n\n{rap_text}")